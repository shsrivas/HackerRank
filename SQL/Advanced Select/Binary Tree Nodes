SELECT N,
CASE
    WHEN P IS NULL THEN 'Root'
    WHEN  N IN (SELECT DISTINCT(P) FROM BST WHERE P IS NOT NULL) THEN 'Inner'
    ELSE 'Leaf'
END AS NODE
FROM BST
order by N;
